version: "3.9"

services:
  mcp:
    build:
      context: .
      dockerfile: mcp_scheduler_server/Dockerfile
    env_file: .env
    dns:
      - 8.8.8.8
      - 1.1.1.1
    ports:
      - "8000:8000"
    volumes:
      - ./data:/app/data

  console:
    build:
      context: .
      dockerfile: console_agent/Dockerfile
    env_file: .env
    dns:
      - 8.8.8.8
      - 1.1.1.1
    depends_on:
      - mcp
    stdin_open: true
    tty: true
    environment:
      MCP_MESSAGES_URL: ${MCP_MESSAGES_URL:-http://mcp:8000/messages}
      MCP_SSE_URL: ${MCP_SSE_URL:-http://mcp:8000/sse}
    command: ["poetry", "run", "python", "-m", "console_agent.app"]
